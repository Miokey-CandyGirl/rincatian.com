<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>练习系统测试</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .test-container { max-width: 800px; margin: 0 auto; padding: 20px; background: white; border-radius: 10px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        button { margin: 5px; padding: 8px 15px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>🧪 练习系统功能测试</h1>
        
        <div class="test-section">
            <h3>1. 脚本加载测试</h3>
            <div id="scriptTest" class="status">检测中...</div>
        </div>
        
        <div class="test-section">
            <h3>2. 函数存在性测试</h3>
            <div id="functionTest" class="status">检测中...</div>
        </div>
        
        <div class="test-section">
            <h3>3. 选择题功能测试</h3>
            <button onclick="testChoiceFunction()">测试选择题</button>
            <div id="choiceTest" class="status">等待测试...</div>
        </div>
        
        <div class="test-section">
            <h3>4. 模拟HTML结构测试</h3>
            <div id="testExerciseContainer">
                <div class="exercise-tabs">
                    <button onclick="testShowExerciseType('choice')">选择题</button>
                    <button onclick="testShowExerciseType('judge')">判断题</button>
                </div>
                
                <div id="choice-exercises" class="exercise-type-section">
                    <div id="choiceContainer">测试容器</div>
                    <button id="choiceNextBtn" onclick="testNextQuestion()">下一题</button>
                </div>
                
                <div id="choiceProgress" style="width: 0%; height: 4px; background: blue;"></div>
                <div id="choiceProgressText">0/0</div>
                
                <div id="choiceFeedback" style="display:none;">反馈区域</div>
            </div>
            <div id="structureTest" class="status">HTML结构已创建</div>
        </div>
        
        <div class="test-section">
            <h3>5. 控制台日志</h3>
            <p>请打开浏览器控制台查看详细日志</p>
        </div>
    </div>

    <script>
        console.log('%c🧪 开始测试练习系统', 'color: blue; font-size: 16px;');
        
        // 测试1: 脚本加载
        window.addEventListener('load', function() {
            setTimeout(() => {
                const scriptEl = document.getElementById('scriptTest');
                scriptEl.textContent = '✅ 页面加载完成';
                scriptEl.className = 'status success';
                
                // 测试2: 函数存在性
                testFunctions();
            }, 100);
        });
        
        function testFunctions() {
            const functions = [
                'showExerciseType',
                'nextChoiceQuestion', 
                'nextJudgeQuestion',
                'restartAllExercises',
                'showExerciseReview'
            ];
            
            let results = [];
            let allExists = true;
            
            functions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    results.push(`✅ ${funcName}: 存在`);
                    console.log(`✅ 函数 ${funcName} 存在`);
                } else {
                    results.push(`❌ ${funcName}: 不存在`);
                    console.error(`❌ 函数 ${funcName} 不存在`);
                    allExists = false;
                }
            });
            
            const testEl = document.getElementById('functionTest');
            testEl.innerHTML = results.join('<br>');
            testEl.className = allExists ? 'status success' : 'status error';
        }
        
        function testChoiceFunction() {
            const testEl = document.getElementById('choiceTest');
            try {
                if (typeof loadChoiceQuestion === 'function') {
                    console.log('🧪 测试 loadChoiceQuestion 函数');
                    // 不直接调用，只检查存在性
                    testEl.textContent = '✅ loadChoiceQuestion 函数存在';
                    testEl.className = 'status success';
                } else {
                    testEl.textContent = '❌ loadChoiceQuestion 函数不存在';
                    testEl.className = 'status error';
                }
            } catch (error) {
                testEl.textContent = '❌ 测试出错: ' + error.message;
                testEl.className = 'status error';
                console.error('测试错误:', error);
            }
        }
        
        function testShowExerciseType(type) {
            console.log(`🧪 测试切换到练习类型: ${type}`);
            if (typeof showExerciseType === 'function') {
                try {
                    showExerciseType(type);
                    console.log(`✅ 成功调用 showExerciseType('${type}')`);
                } catch (error) {
                    console.error(`❌ 调用 showExerciseType('${type}') 失败:`, error);
                }
            } else {
                console.error('❌ showExerciseType 函数不存在');
            }
        }
        
        function testNextQuestion() {
            console.log('🧪 测试下一题功能');
            if (typeof nextChoiceQuestion === 'function') {
                try {
                    // 不直接调用，避免出错
                    console.log('✅ nextChoiceQuestion 函数可调用');
                } catch (error) {
                    console.error('❌ nextChoiceQuestion 调用失败:', error);
                }
            } else {
                console.error('❌ nextChoiceQuestion 函数不存在');
            }
        }
        
        console.log('%c🧪 测试准备完成，等待页面加载', 'color: green;');
    </script>
    
    <!-- 引入练习系统脚本 -->
    <script src="grammar-exercises.js"></script>
</body>
</html>