<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•è¯æ±‡è´¡çŒ®åŠŸèƒ½</title>
    <link rel="stylesheet" href="user-profile.css">
    <style>
        body {
            background: linear-gradient(135deg, #1a237e, #3f51b5);
            color: white;
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
        }
        
        .test-section {
            margin-bottom: 30px;
        }
        
        .test-section h2 {
            color: #ffd700;
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
            padding-bottom: 10px;
        }
        
        .btn {
            background: #00bcd4;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        .btn:hover {
            background: #0097a7;
        }
        
        .result {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            padding: 15px;
            margin-top: 15px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>è¯æ±‡è´¡çŒ®åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="test-section">
            <h2>æ·»åŠ æµ‹è¯•æ•°æ®</h2>
            <button class="btn" onclick="addTestData()">æ·»åŠ æµ‹è¯•ç”³è¯·è®°å½•</button>
            <button class="btn" onclick="clearTestData()">æ¸…ç©ºæµ‹è¯•æ•°æ®</button>
        </div>
        
        <div class="test-section">
            <h2>æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®</h2>
            <button class="btn" onclick="simulateUserLogin()">æ¨¡æ‹Ÿç”¨æˆ·ç™»å½•</button>
            <button class="btn" onclick="simulateUserLogout()">æ¨¡æ‹Ÿç”¨æˆ·ç™»å‡º</button>
        </div>
        
        <div class="test-section">
            <h2>æµ‹è¯•ç»“æœ</h2>
            <div class="result" id="testResult">ç‚¹å‡»æŒ‰é’®è¿›è¡Œæµ‹è¯•</div>
        </div>
        
        <div class="test-section">
            <h2>è¯æ±‡è´¡çŒ®æ˜¾ç¤ºæµ‹è¯•</h2>
            <div id="wordContributions" style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px;">
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“</div>
                    <div class="empty-text">æ‚¨è¿˜æ²¡æœ‰è´¡çŒ®ä»»ä½•è¯æ±‡</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿè®¤è¯ç³»ç»Ÿ
        window.authSystem = {
            currentUser: null
        };
        
        // æ¨¡æ‹Ÿç”¨æˆ·ç™»å½•
        function simulateUserLogin() {
            window.authSystem.currentUser = {
                id: 'test_user_001',
                username: 'æµ‹è¯•ç”¨æˆ·'
            };
            document.getElementById('testResult').textContent = 'ç”¨æˆ·å·²ç™»å½•: ' + window.authSystem.currentUser.username;
        }
        
        // æ¨¡æ‹Ÿç”¨æˆ·ç™»å‡º
        function simulateUserLogout() {
            window.authSystem.currentUser = null;
            document.getElementById('testResult').textContent = 'ç”¨æˆ·å·²ç™»å‡º';
        }
        
        // æ·»åŠ æµ‹è¯•æ•°æ®
        function addTestData() {
            if (!window.authSystem.currentUser) {
                document.getElementById('testResult').textContent = 'è¯·å…ˆæ¨¡æ‹Ÿç”¨æˆ·ç™»å½•';
                return;
            }
            
            // åˆ›å»ºæµ‹è¯•ç”³è¯·è®°å½•
            const testRequests = [
                {
                    id: 'request_1',
                    linkaitiya: 'testword1',
                    chinese: 'æµ‹è¯•è¯1',
                    type: 'åè¯',
                    reason: 'åœ¨é˜…è¯»ã€Šå…‰çº¿ä¼ å¥‡ã€‹æ—¶é‡åˆ°ï¼Œå¸Œæœ›æ·»åŠ åˆ°è¯å…¸ä¸­',
                    requestedBy: window.authSystem.currentUser.id,
                    requestedByName: window.authSystem.currentUser.username,
                    requestedAt: new Date().toISOString(),
                    status: 'pending'
                },
                {
                    id: 'request_2',
                    linkaitiya: 'testword2',
                    chinese: 'æµ‹è¯•è¯2',
                    type: 'åŠ¨è¯',
                    reason: 'è¿™æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„åŠ¨è¯ï¼Œåœ¨æ—¥å¸¸äº¤æµä¸­ç»å¸¸ä½¿ç”¨',
                    requestedBy: window.authSystem.currentUser.id,
                    requestedByName: window.authSystem.currentUser.username,
                    requestedAt: new Date(Date.now() - 86400000).toISOString(), // æ˜¨å¤©
                    status: 'approved'
                },
                {
                    id: 'request_3',
                    linkaitiya: 'testword3',
                    chinese: 'æµ‹è¯•è¯3',
                    type: 'å½¢å®¹è¯',
                    reason: 'ç”¨äºæè¿°äº‹ç‰©çš„ç‰¹å¾ï¼Œå»ºè®®æ·»åŠ ',
                    requestedBy: window.authSystem.currentUser.id,
                    requestedByName: window.authSystem.currentUser.username,
                    requestedAt: new Date(Date.now() - 172800000).toISOString(), // å‰å¤©
                    status: 'rejected'
                }
            ];
            
            // ä¿å­˜åˆ°localStorage
            localStorage.setItem('linkaitiya_word_requests', JSON.stringify(testRequests));
            document.getElementById('testResult').textContent = 'å·²æ·»åŠ 3æ¡æµ‹è¯•ç”³è¯·è®°å½•';
            
            // æ˜¾ç¤ºè´¡çŒ®è®°å½•
            displayTestContributions();
        }
        
        // æ¸…ç©ºæµ‹è¯•æ•°æ®
        function clearTestData() {
            localStorage.removeItem('linkaitiya_word_requests');
            document.getElementById('testResult').textContent = 'å·²æ¸…ç©ºæµ‹è¯•æ•°æ®';
            
            // æ˜¾ç¤ºç©ºçŠ¶æ€
            document.getElementById('wordContributions').innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“</div>
                    <div class="empty-text">æ‚¨è¿˜æ²¡æœ‰è´¡çŒ®ä»»ä½•è¯æ±‡</div>
                </div>
            `;
        }
        
        // æ˜¾ç¤ºæµ‹è¯•è´¡çŒ®è®°å½•
        function displayTestContributions() {
            if (!window.authSystem.currentUser) {
                document.getElementById('testResult').textContent = 'è¯·å…ˆæ¨¡æ‹Ÿç”¨æˆ·ç™»å½•';
                return;
            }
            
            try {
                // ä»localStorageè·å–æ‰€æœ‰å•è¯ç”³è¯·è®°å½•
                let allRequests = JSON.parse(localStorage.getItem('linkaitiya_word_requests') || '[]');
                
                // ç­›é€‰å‡ºå½“å‰ç”¨æˆ·çš„ç”³è¯·è®°å½•
                const userRequests = allRequests.filter(request => request.requestedBy === window.authSystem.currentUser.id);
                
                // æŒ‰æ—¶é—´å€’åºæ’åˆ—
                userRequests.sort((a, b) => new Date(b.requestedAt) - new Date(a.requestedAt));
                
                // æ˜¾ç¤ºç”³è¯·è®°å½•
                const contributionsContainer = document.getElementById('wordContributions');
                if (contributionsContainer) {
                    if (userRequests.length > 0) {
                        contributionsContainer.innerHTML = '';
                        userRequests.forEach(request => {
                            const contributionItem = document.createElement('div');
                            contributionItem.className = 'history-item';
                            
                            // æ„å»ºè¯æ€§ä¿¡æ¯
                            const typeInfo = request.type ? `<div class="word-type">è¯æ€§ï¼š${request.type}</div>` : '';
                            
                            // æ„å»ºç†ç”±ä¿¡æ¯
                            const reasonInfo = request.reason ? `<div class="request-reason">ç”³è¯·ç†ç”±ï¼š${request.reason}</div>` : '';
                            
                            contributionItem.innerHTML = `
                                <div class="history-header">
                                    <div class="history-word">${request.linkaitiya}</div>
                                    <div class="history-status ${request.status === 'approved' ? 'mastered' : request.status === 'rejected' ? 'rejected' : 'learning'}">
                                        ${request.status === 'approved' ? 'å·²é€šè¿‡' : request.status === 'rejected' ? 'å·²æ‹’ç»' : 'å¾…å®¡æ ¸'}
                                    </div>
                                </div>
                                <div class="history-meaning">${request.chinese}</div>
                                ${typeInfo}
                                ${reasonInfo}
                                <div class="history-date">${new Date(request.requestedAt).toLocaleDateString('zh-CN')}</div>
                            `;
                            contributionsContainer.appendChild(contributionItem);
                        });
                    } else {
                        contributionsContainer.innerHTML = `
                            <div class="empty-state">
                                <div class="empty-icon">ğŸ“</div>
                                <div class="empty-text">æ‚¨è¿˜æ²¡æœ‰è´¡çŒ®ä»»ä½•è¯æ±‡</div>
                            </div>
                        `;
                    }
                }
                
                document.getElementById('testResult').textContent = 'å·²æ˜¾ç¤ºè¯æ±‡è´¡çŒ®è®°å½•ï¼Œå…±' + userRequests.length + 'æ¡';
            } catch (error) {
                document.getElementById('testResult').textContent = 'æ˜¾ç¤ºè´¡çŒ®è®°å½•å¤±è´¥: ' + error.message;
            }
        }
    </script>
</body>
</html>